@model IEnumerable<Property>


@{
    ViewData["Title"] = "Ingatlanok";
}

<h4 class="mb-3 fw-bold fst-italic text-secondary">Ingatlanok keresése</h4>

<form method="get" class="row g-3 mb-4 p-4 bg-white shadow-sm rounded">

    <div class="col-md-4">
        <label class="form-label fw-bold fst-italic text-primary">Kulcsszó</label>
        <input name="keyword" class="form-control" placeholder="pl. kert, felújított, panoráma" />
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold fst-italic text-primary">Kategória</label>
        <select name="category" class="form-select shadow-sm">
            <option value="">(Mind)</option>
            <option>lakás</option>
            <option>ház</option>
            <option>telek</option>
            <option>iroda</option>
        </select>
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold">
        <span class="text-dark">Eladó</span> /
        <span class="text-danger">Kiadó</span>
        </label>
        <select name="listingType" class="form-select">
            <option value="">(Mind)</option>
            <option>eladó</option>
            <option>kiadó</option>
        </select>
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold fst-italic text-primary">Szobaszám</label>
        <input type="number" name="rooms" class="form-control" min="0" />
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold fst-italic text-primary">Min. alapterület</label>
        <input type="number" name="minArea" class="form-control" min="0" />
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold fst-italic text-primary">Max. alapterület</label>
        <input type="number" name="maxArea" class="form-control" min="0" />
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold fst-italic text-primary">Min. ár (Ft)</label>
        <input type="number" name="minPrice" class="form-control" min="0" />
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold fst-italic text-primary">Max. ár (Ft)</label>
        <input type="number" name="maxPrice" class="form-control" min="0" />
    </div>

    <div class="col-md-2">
        <label class="form-label fw-bold fst-italic text-primary">Rendezés</label>
        <select name="sort" class="form-select">
            <option value="">Legújabb</option>
            <option value="price_asc">Ár (növekvő)</option>
            <option value="price_desc">Ár (csökkenő)</option>
            <option value="area_asc">Alapterület (növekvő)</option>
            <option value="area_desc">Alapterület (csökkenő)</option>
        </select>
    </div>

    <div class="col-md-12">
        <button class="btn bg-light text-dark shadow-sm rounded-pill px-4 py-2 fw-semibold">Keresés</button>
        <a href="/Property" class="btn bg-light text-dark shadow-sm rounded-pill px-4 py-2 fw-semibold">Alaphelyzet</a>
    </div>

</form>


@{
    ViewData["Title"] = "Ingatlanok listája";
}




<h1 class="mb-4 fw-bold fst-italic text-secondary">Ingatlanok</h1>

<!--
    Egyszerű kereső űrlap az ingatlanok szűrésére.
    A form GET metódussal küldi a paramétereket a PropertyController Index akciójához.
    A paraméterek nevei: keresoszo, kategoria, minAr, maxAr
-->

<form asp-action="Index" method="get" class="mb-3">
    <div class="row">
        <!-- Keresőszó mező: címre és leírásra keres -->
        <div class="col-md-3">
            <label for="keresoszo" class="form-label fw-bold fst-italic text-primary">Keresés (cím / leírás)</label>
            <input type="text"
                   id="keresoszo"
                   name="keresoszo"
                   value="@Context.Request.Query["keresoszo"]"
                   class="form-control" />
        </div>

        <!-- Kategória legördülő (enum PropertyCategory) -->
        <div class="col-md-2">
            <label for="kategoria" class="form-label fw-bold fst-italic text-primary">Kategória</label>
            <select id="kategoria"
                    name="kategoria"
                    class="form-select"
                    asp-items="Html.GetEnumSelectList<PropertyCategory>()">
                <option value="">-- Mindegy --</option>
            </select>
        </div>

        <!-- Minimális ár (Ft) -->
        <div class="col-md-2">
            <label for="minAr" class="form-label fw-bold fst-italic text-primary">Min. ár (Ft)</label>
            <input type="number"
                   id="minAr"
                   name="minAr"
                   value="@Context.Request.Query["minAr"]"
                   class="form-control" />
        </div>

        <!-- Maximális ár (Ft) -->
        <div class="col-md-2">
            <label for="maxAr" class="form-label fw-bold fst-italic text-primary">Max. ár (Ft)</label>
            <input type="number"
                   id="maxAr"
                   name="maxAr"
                   value="@Context.Request.Query["maxAr"]"
                   class="form-control" />
        </div>

        <!-- Keresés gomb -->
        <div class="col-md-3 d-flex align-items-end">
            <button type="submit" class="btn bg-light text-dark shadow-sm rounded-pill px-4 py-2 fw-semibold">Keresés</button>
            <a asp-action="Index" class="btn bg-light text-dark shadow-sm rounded-pill px-4 py-2 fw-semibold">Szűrés törlése</a>
        </div>
    </div>
</form>

<!-- Új hirdetés létrehozása gomb (csak bejelentkezetteknek lesz engedélyezve a szerver oldalon) -->
<p>
    <a asp-action="Create" class="btn bg-light text-dark shadow-sm rounded-pill px-4 py-2 fw-semibold">Új ingatlan hirdetés feladása</a>
</p>

<!--
    Táblázat az ingatlan hirdetések listájához.
    A modell: IEnumerable<Property>, azaz Property objektumok listája.
-->

<table class="table table-striped">
    <thead>
        <tr>
            <th>Kategória</th>
            <th>Cím</th>
            <th>Alapterület (m²)</th>
            <th>Szobaszám</th>
            <th>Ár (Ft)</th>
            <th>Típus</th>
            <th>Létrehozva</th>
            <th></th> @* Műveletek oszlop (Részletek / Szerkesztés / Törlés) *@
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <!--
                    A Category egy enum (PropertyCategory), amelyet a ToString() szépen kiír,
                    pl. Lakás, Ház, Telek, Iroda.
                -->
                <td>@item.Category</td>

                <!-- Ingatlan címe -->
                <td>@item.Cim</td>

                <!-- Alapterület -->
                <td>@item.Alapterulet</td>

                <!-- Szobaszám -->
                <td>@item.Szobaszam</td>

                <!-- Ár formázva, ezres tagolóval -->
                <td>@string.Format("{0:N0}", item.Ar)</td>

                <!-- ListingType enum: Elado vagy Berles -->
                <td>@item.ListingType</td>

                <!-- Létrehozás dátuma -->
                <td>@item.Letrehozva.ToLocalTime().ToString("yyyy.MM.dd HH:mm")</td>

                <!-- Műveletek oszlop -->
                <td>
                    <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-info">Részletek</a>
                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-warning">Szerkesztés</a>
                    <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-danger">Törlés</a>
                </td>
            </tr>
        }
    </tbody>
</table>
